<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ascalon Capital - Fee Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        .brand-gradient-text { background: linear-gradient(90deg, #3b82f6, #2563eb); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .input-group { display: flex; align-items: center; }
        
        .input-group-text { display: inline-flex; align-items: center; padding: 0 0.75rem; background-color: #e5e7eb; border: 1px solid #d1d5db; color: #4b5563; font-size: 0.875rem; height: 42px; }
        .input-group-text-left { border-right: 0; border-radius: 0.375rem 0 0 0.375rem; }
        .input-group-text-right { border-left: 0; border-radius: 0 0.375rem 0.375rem 0; }
        
        select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; }
        
        .modal-backdrop { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(17, 24, 39, 0.6); display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; z-index: 50; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-backdrop.active { opacity: 1; visibility: visible; }
        .modal-content { background-color: white; padding: 2rem; border-radius: 1rem; width: 90%; max-width: 500px; transform: scale(0.95); transition: transform 0.3s ease; max-height: 90vh; overflow-y: auto;}
        .modal-backdrop.active .modal-content { transform: scale(1); }

        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2563eb; }
        input:checked + .slider:before { transform: translateX(22px); }
    </style>
</head>
<body class="antialiased text-gray-800">

    <button id="openSettingsBtn" class="fixed bottom-5 right-5 bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 transition focus:outline-none focus:ring-2 focus:ring-blue-500 z-40" title="Admin Settings">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
    </button>

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl">
        <header class="flex items-center justify-between mb-8">
            <div class="flex items-center space-x-4">
                <img src="data:image/png;base64,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68BfuhNn3ln8OvA43zqh+N3RlTPLgS9zit+VTa3xrZ+8+D3SlX/ZuXtbqWIgDMMbEICERIQQRSABCbrBNoIognwJtglKJLbcATKLYO+eP9vjOWc8ft8ePo00wSNpCb7scPEj0pX2fWvtxXPgK7pon/ldFn99c6LS3in71tqL58DXNHvme1s8B96ob626eGSryrRFLO3FD2tTd+Bbay5+cLpSkjJ8qbv4kW1q+7613uI58KJUz7zq4ge3qa371mqL58AL0zzziouHrjTuWystngPfpK9KZ15v8djUjfqgA19qLR6buklqvrXW4jnwJ/O+tcbioSub9V/E6mPx2NR/suxbKyweurJhOvClyuKhK28Z962bL54D37rbme9g8djUd5n1rVsvngOvUOszr7D4dOCRrf5m2rduu3hkK5XSmbe+eGxqpb43/YE3XjyylVItfWuFxWNTTzPrWzdaPAdeuQRf2l08dOVsJn3rNovnwKvXxrdWWDw29WrmfGvx4jnwe5XOvMXFc+CXM+hbSxfPgd8vKXypsXhs6s2M+dZNFg9duVMJvrS1eOjKraz51i0Wj02tnvzMaywemzovU7511eI58MeVzryVxXPgs7LlW4sXD125czW+tcbisalLsuNbCxcPXbl/Cb40sHjoyvws+dZli+fAG0nmW8sXj01dkQ3fOnvxHHhTpTO/0+I58LYS+daixSNbHZgAvhQvHpv64D4JfGvB4qErD00AX8oWj019fALfOmPxHHizCc68YPFX6Mrjq/WttxfPgbdc4ZmXLx660kqVvvX64jnw9ivzreWL//b2RDaq8q3rFo9Nbagl37p28Rz4bqrxrSsWD11prSRi7bF4bGpzlfvW5YuHrrTXFL5UWDw2tcVe//hV1mTxHPguS2dedfHY1FYr9K0fF8+B77Ql+FK+eOhK45X51jmLR7bqonTm9Rb/GZvabiW+dcbika066XbmCxfPgfdQiW+dFs+Bd1KiMsSLh67ssWzfOi2eA++m5Fs3Wzw2dU/l+9aBA++p7DMfOfC+yvatAwfeVU9fJIvHpu64LN96dvHQlT2X4Mu6xUNXdt6LDN96unhkq+57Orda/M9XJ+qpHN86cODdlXPmIwfeYxm+deDAO+z9uXDx2NRe2vCt/y0eutJXCb7MWzx0pbO2fOvAgffZ5Zy3eGxqd6371oED77T1Mx85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" alt="Ascalon Capital Logo" class="h-12 w-12"><div><h1 class="text-2xl font-bold text-gray-900">Ascalon Capital</h1><p class="text-md text-gray-600">Prospect Fee Calculator</p></div>
            </div>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-6 border-b pb-3">
                    <h2 class="text-xl font-bold brand-gradient-text">Client Assumptions</h2>
                    <div class="flex items-center">
                        <span class="text-sm font-medium text-gray-700 mr-3">Manual Fee</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="feeModeToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="text-sm font-medium text-gray-700 ml-3">Tiered</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <label for="addressableFUA" class="block text-sm font-medium text-gray-700 mb-1">Addressable FUA (On Platform)</label>
                        <div class="input-group">
                            <span class="input-group-text input-group-text-left">$</span>
                            <input type="text" id="addressableFUA" value="300,000,000" inputmode="numeric" class="w-full p-2 border border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        </div>
                    </div>
                    <div>
                        <label for="growthAssumption" class="block text-sm font-medium text-gray-700 mb-1">Growth Assumption p.a.</label>
                        <div class="input-group">
                            <input type="number" id="growthAssumption" value="10" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            <span class="input-group-text input-group-text-right">%</span>
                        </div>
                    </div>
                    <div>
                        <label for="conversionAssumption" class="block text-sm font-medium text-gray-700 mb-1">2 yr Conversion Assumption</label>
                        <div class="relative w-full">
                             <select id="conversionAssumption" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" style="height: 42px;">
                                 <option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="50">50</option><option value="60" selected>60</option><option value="70">70</option><option value="80">80</option><option value="90">90</option><option value="100">100</option>
                            </select>
                            <span class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 bg-gray-200 rounded-r-md border-l border-gray-300">%</span>
                        </div>
                    </div>
                    <div id="manualBaseFeeContainer">
                        <label for="manualBaseFee" class="block text-sm font-medium text-gray-700 mb-1">Manual Base Fee</label>
                        <div class="input-group">
                            <input type="number" id="manualBaseFee" step="0.01" value="0.10" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            <span class="input-group-text input-group-text-right">%</span>
                        </div>
                    </div>

                    <div class="md:col-span-2 border-t pt-6">
                        <div class="flex items-center justify-between mb-4">
                             <h3 class="text-lg font-semibold text-gray-800">ACE Revenue</h3>
                             <div class="flex items-center">
                                 <span class="text-sm font-medium text-gray-700 mr-3">Exclude</span>
                                 <label class="toggle-switch">
                                     <input type="checkbox" id="includeAceToggle" checked>
                                     <span class="slider"></span>
                                 </label>
                                 <span class="text-sm font-medium text-gray-700 ml-3">Include</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div id="aceFeeContainer">
                                <label for="aceFee" class="block text-sm font-medium text-gray-700 mb-1">ACE Fee</label>
                                <div class="input-group">
                                    <input type="number" id="aceFee" step="0.01" value="0.38" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                    <span class="input-group-text input-group-text-right">%</span>
                                </div>
                            </div>
                            <div id="aceWeightContainer">
                                <label for="aceWeight" class="block text-sm font-medium text-gray-700 mb-1">ACE Weight</label>
                                <div class="input-group">
                                    <input type="number" id="aceWeight" value="10" class="w-full p-2 border border-gray-300 rounded-l-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                    <span class="input-group-text input-group-text-right">%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                     <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 border-t pt-6">
                         <div>
                             <label for="minRevenue" class="block text-sm font-medium text-gray-700 mb-1">Min Revenue</label>
                             <div class="input-group">
                                 <span class="input-group-text input-group-text-left">$</span>
                                 <input type="text" id="minRevenue" value="300,000" inputmode="numeric" class="w-full p-2 border border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                             </div>
                         </div>
                         <div>
                             <label for="targetRevenue" class="block text-sm font-medium text-gray-700 mb-1">Target Revenue</label>
                             <div class="input-group">
                                 <span class="input-group-text input-group-text-left">$</span>
                                 <input type="text" id="targetRevenue" value="500,000" inputmode="numeric" class="w-full p-2 border border-gray-300 rounded-r-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                             </div>
                         </div>
                     </div>
                </div>
            </div>

            <div class="lg:col-span-1 bg-white p-6 sm:p-8 rounded-2xl shadow-lg flex flex-col">
                <h2 class="text-xl font-bold mb-6 border-b pb-3 brand-gradient-text">Calculated Results</h2>
                <div class="space-y-5 flex-grow">
                    <div class="flex justify-between items-center"><span class="text-gray-600">Min Fee:</span><span id="minFee" class="font-bold text-lg text-gray-800">0.00%</span></div>
                    <div class="flex justify-between items-center"><span class="text-gray-600">Target Fee:</span><span id="targetFee" class="font-bold text-lg text-gray-800">0.00%</span></div>
                    <hr class="my-4">
                    <div class="flex justify-between items-center" title="The blended base fee rate based on the current FUA and tiered structure">
                        <span class="text-gray-600">Effective Base Fee:</span>
                        <span id="effectiveBaseFee" class="font-bold text-lg text-gray-800">0.00%</span>
                    </div>
                    <div class="flex justify-between items-center"><span class="text-gray-600">Base Revenue:</span><span id="baseRevenue" class="font-bold text-lg text-gray-800">$0.00</span></div>
                    <div class="flex justify-between items-center"><span class="text-gray-600">ACE Revenue:</span><span id="aceRevenue" class="font-bold text-lg text-gray-800">$0.00</span></div>
                </div>
                <div class="mt-6 pt-6 border-t-2 border-dashed">
                     <div id="warningMessage" class="hidden p-3 mb-4 text-sm text-red-800 rounded-lg bg-red-50 text-center" role="alert">
                         <span id="warningMessageText" class="font-medium">Approval required from ELT</span>
                     </div>
                    <div class="bg-gray-100 rounded-lg p-4 text-center">
                        <p class="text-sm font-medium text-gray-600 uppercase tracking-wider">Total Revenue</p>
                        <p id="totalRevenue" class="text-4xl font-extrabold text-blue-600 transition-colors duration-300">$0.00</p>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-3 bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4">
                    <h2 class="text-xl font-bold brand-gradient-text">Goal Seeking: Required Base Fee</h2>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm font-medium text-gray-700">Min Revenue</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="chartTargetToggle" checked>
                            <span class="slider"></span>
                        </label>
                        <span class="text-sm font-medium text-gray-700">Target Revenue</span>
                    </div>
                </div>
                <div class="h-50">
                    <canvas id="feeChart"></canvas>
                </div>
            </div>
            
            <div class="lg:col-span-3 bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
                 <h2 class="text-xl font-bold mb-4 brand-gradient-text">Conversion Assumption Guidance</h2>
                 <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm text-gray-600">
                        <thead class="bg-gray-50 text-xs text-gray-700 uppercase">
                            <tr>
                                <th scope="col" class="px-6 py-3 rounded-l-lg">Scenario</th>
                                <th scope="col" class="px-6 py-3 rounded-r-lg text-right">Guidance %</th>
                            </tr>
                        </thead>
                        <tbody id="guidanceTableBody">
                            <tr id="guidance-row-70" class="border-b transition-colors duration-300"><td class="px-6 py-4 font-medium text-gray-900">Single Platform, Model Portfolios and Single Ownership structure</td><td class="px-6 py-4 text-right font-semibold">70%</td></tr>
                            <tr id="guidance-row-60" class="border-b transition-colors duration-300"><td class="px-6 py-4 font-medium text-gray-900">Multi Platform, Model Portfolios and Single Ownership Structure</td><td class="px-6 py-4 text-right font-semibold">60%</td></tr>
                            <tr id="guidance-row-50" class="border-b transition-colors duration-300"><td class="px-6 py-4 font-medium text-gray-900">Multi Platform, No Model Portfolios, Co-Op Model</td><td class="px-6 py-4 text-right font-semibold">50%</td></tr>
                            <tr id="guidance-row-40" class="transition-colors duration-300"><td class="px-6 py-4 font-medium text-gray-900">Multi Platform, No Model Portfolios, Co-Op Model</td><td class="px-6 py-4 text-right font-semibold">40%</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <div id="passwordModal" class="modal-backdrop"><div class="modal-content">
        <h3 class="text-lg font-bold text-center text-gray-800 mb-1">Admin Access</h3>
        <p class="text-sm text-center text-gray-500 mb-4">Enter the password to access settings.</p>
        <div class="space-y-4">
            <input type="password" id="passwordInput" placeholder="Password" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
            <p id="passwordError" class="text-red-600 text-sm text-center hidden">Incorrect password. Please try again.</p>
            <button id="loginBtn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition">Unlock</button>
        </div>
    </div></div>

    <div id="settingsModal" class="modal-backdrop"><div class="modal-content">
        <h3 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">Admin Settings</h3>
        <div class="space-y-6">
            
            <div>
                <h4 class="font-semibold text-gray-700 mb-2">Default Tiered Fee Structure</h4>
                <div class="space-y-3 p-4 border rounded-lg">
                    <div class="grid grid-cols-2 gap-4 items-end">
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Tier 1: FUA up to ($)</label>
                            <input type="text" id="tier1-fua" inputmode="numeric" class="w-full p-2 border border-gray-300 rounded-md text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Fee (%)</label>
                            <input type="number" step="0.01" id="tier1-fee" class="w-full p-2 border border-gray-300 rounded-md text-sm">
                        </div>
                    </div>
                     <div class="grid grid-cols-2 gap-4 items-end">
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Tier 2: FUA up to ($)</label>
                            <input type="text" id="tier2-fua" inputmode="numeric" class="w-full p-2 border border-gray-300 rounded-md text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Fee (%)</label>
                            <input type="number" step="0.01" id="tier2-fee" class="w-full p-2 border border-gray-300 rounded-md text-sm">
                        </div>
                    </div>
                      <div class="grid grid-cols-2 gap-4 items-end">
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Tier 3: FUA above prev.</label>
                             <input type="text" disabled value="And above" class="w-full p-2 border bg-gray-100 border-gray-300 rounded-md text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-600">Fee (%)</label>
                            <input type="number" step="0.01" id="tier3-fee" class="w-full p-2 border border-gray-300 rounded-md text-sm">
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <h4 class="font-semibold text-gray-700 mb-2">Calculator & Chart Settings</h4>
                <div class="p-4 border rounded-lg space-y-4">
                    <div>
                        <label for="settingGrowthYears" class="block text-sm font-medium text-gray-700 mb-1">Growth Compounding Years</label>
                        <input type="number" id="settingGrowthYears" class="w-full p-2 border border-gray-300 rounded-md">
                        <p class="text-xs text-gray-500 mt-1">Used in ACE Revenue calc: (1 + Growth)^Years</p>
                    </div>
                </div>
            </div>
            
            <div>
                <h4 class="font-semibold text-gray-700 mb-2">Security</h4>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 border rounded-lg">
                    <div>
                        <label for="settingNewPassword" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
                        <input type="password" id="settingNewPassword" class="w-full p-2 border border-gray-300 rounded-md">
                    </div>
                    <div>
                        <label for="settingConfirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
                        <input type="password" id="settingConfirmPassword" class="w-full p-2 border border-gray-300 rounded-md">
                    </div>
                    <p id="passwordUpdateError" class="sm:col-span-2 text-red-600 text-sm hidden">Passwords do not match.</p>
                    <p id="passwordUpdateSuccess" class="sm:col-span-2 text-green-600 text-sm hidden">Password updated successfully.</p>
                </div>
            </div>

        </div>
        <div class="mt-6 flex flex-col sm:flex-row-reverse gap-3">
            <button id="saveSettingsBtn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition">Save Changes</button>
            <button id="resetSettingsBtn" class="w-full bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-md hover:bg-gray-300 transition">Reset to Defaults</button>
        </div>
    </div></div>
    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const defaultConfig = {
            password: "admin",
            warningThreshold: 250000,
            warningMessage: "Approval required from ELT",
            growthCompoundingYears: 2,
            feeMode: 'tiered', // 'tiered' or 'manual'
            includeACE: true,
            manualBaseFee: 0.1, // Stored as 0.1 for 0.1%
            feeTiers: [
                { fuaUpTo: 50_000_000, fee: 0.12 },
                { fuaUpTo: 250_000_000, fee: 0.10 },
                { fuaUpTo: Infinity, fee: 0.08 }
            ]
        };
        let config = { ...defaultConfig };
        let feeChartInstance = null;

        const DOMElements = {
            inputs: {
                addressableFUA: document.getElementById('addressableFUA'), growthAssumption: document.getElementById('growthAssumption'),
                conversionAssumption: document.getElementById('conversionAssumption'), aceFee: document.getElementById('aceFee'),
                aceWeight: document.getElementById('aceWeight'), minRevenue: document.getElementById('minRevenue'),
                targetRevenue: document.getElementById('targetRevenue'),
                manualBaseFee: document.getElementById('manualBaseFee'),
            },
            containers: {
                manualBaseFee: document.getElementById('manualBaseFeeContainer'),
                aceFee: document.getElementById('aceFeeContainer'),
                aceWeight: document.getElementById('aceWeightContainer'),
            },
            toggles: {
                feeMode: document.getElementById('feeModeToggle'),
                includeAce: document.getElementById('includeAceToggle'),
            },
            outputs: {
                minFee: document.getElementById('minFee'), targetFee: document.getElementById('targetFee'),
                baseRevenue: document.getElementById('baseRevenue'), aceRevenue: document.getElementById('aceRevenue'),
                totalRevenue: document.getElementById('totalRevenue'), effectiveBaseFee: document.getElementById('effectiveBaseFee'),
            },
            warnings: { message: document.getElementById('warningMessage'), text: document.getElementById('warningMessageText'), },
            chart: { canvas: document.getElementById('feeChart'), targetToggle: document.getElementById('chartTargetToggle'), },
            guidance: { tableBody: document.getElementById('guidanceTableBody') },
            admin: {
                openBtn: document.getElementById('openSettingsBtn'),
                password: {
                    modal: document.getElementById('passwordModal'), input: document.getElementById('passwordInput'), error: document.getElementById('passwordError'),
                    loginBtn: document.getElementById('loginBtn'), newPass: document.getElementById('settingNewPassword'),
                    confirmPass: document.getElementById('settingConfirmPassword'), updateError: document.getElementById('passwordUpdateError'),
                    updateSuccess: document.getElementById('passwordUpdateSuccess'),
                },
                settings: {
                    modal: document.getElementById('settingsModal'), saveBtn: document.getElementById('saveSettingsBtn'), resetBtn: document.getElementById('resetSettingsBtn'),
                    growthYears: document.getElementById('settingGrowthYears'),
                    tier1FUA: document.getElementById('tier1-fua'), tier1Fee: document.getElementById('tier1-fee'),
                    tier2FUA: document.getElementById('tier2-fua'), tier2Fee: document.getElementById('tier2-fee'),
                    tier3Fee: document.getElementById('tier3-fee'),
                }
            }
        };

        const currencyInputs = [DOMElements.inputs.addressableFUA, DOMElements.inputs.minRevenue, DOMElements.inputs.targetRevenue, DOMElements.admin.settings.tier1FUA, DOMElements.admin.settings.tier2FUA];
        
        const formatCurrency = (v) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(v);
        const formatPercent = (v) => (v * 100).toFixed(3) + '%';
        const cleanNumberString = (s) => String(s).replace(/[^0-9.]/g, '');
        const formatNumberWithCommas = (s) => {
            const parts = cleanNumberString(s).split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return parts.join('.');
        }

        function calculateRequiredBaseFeePercent(fua, targetRevenue, includeACE) {
            const { b4, b5, b7, b8 } = getParsedInputs();
            if (fua === 0 || b5 === 0) return 0;
            let aceRevenueContribution = 0;
            if (includeACE) {
                const denominator = b5 * (fua * Math.pow(1 + b4, config.growthCompoundingYears));
                aceRevenueContribution = denominator * b8 * b7;
            }
            const requiredBaseRevenue = targetRevenue - aceRevenueContribution;
            const requiredEffectiveBaseFee = requiredBaseRevenue / (fua * b5);
            return requiredEffectiveBaseFee < 0 ? 0 : requiredEffectiveBaseFee;
        }
        
        function updateChart() {
            if (!feeChartInstance) return;

            const isTargetRevenue = DOMElements.chart.targetToggle.checked;
            const chartTargetKey = isTargetRevenue ? 'targetRevenue' : 'minRevenue';
            const revenueTargetValue = parseFloat(cleanNumberString(DOMElements.inputs[chartTargetKey].value)) || 0;
            const includeACEinChart = DOMElements.toggles.includeAce.checked;

            const fuaPoints = [50_000_000, 100_000_000, 250_000_000, 500_000_000, 750_000_000, 1_000_000_000];
            const requiredFeeData = fuaPoints.map(fua => calculateRequiredBaseFeePercent(fua, revenueTargetValue, includeACEinChart));
            
            feeChartInstance.data.labels = fuaPoints.map(l => `$${(l/1_000_000).toFixed(0)}M`);
            feeChartInstance.data.datasets = [{
                label: `Required Base Fee % to hit ${isTargetRevenue ? 'Target' : 'Min'} Revenue (${formatCurrency(revenueTargetValue)})`,
                data: requiredFeeData,
                borderColor: isTargetRevenue ? 'rgb(34, 197, 94)' : 'rgb(59, 130, 246)',
                backgroundColor: isTargetRevenue ? 'rgba(34, 197, 94, 0.5)' : 'rgba(59, 130, 246, 0.5)',
                fill: false, tension: 0.1
            }];
            feeChartInstance.update();
        }

        function calculateTieredBaseRevenue(fua) {
            let revenue = 0;
            let remainingFUA = fua;
            let lastTierBoundary = 0;
            // Create a sorted copy for calculation only, leaving the original config array untouched.
            const sortedTiers = [...config.feeTiers].sort((a, b) => a.fuaUpTo - b.fuaUpTo);
            for (const tier of sortedTiers) {
                if (remainingFUA <= 0) break;
                const tierBracketSize = tier.fuaUpTo - lastTierBoundary;
                const fuaInThisTier = Math.min(remainingFUA, tierBracketSize);
                revenue += fuaInThisTier * (tier.fee / 100);
                remainingFUA -= fuaInThisTier;
                lastTierBoundary = tier.fuaUpTo;
            }
            return revenue;
        }

        function getParsedInputs() {
            return {
                b3: parseFloat(cleanNumberString(DOMElements.inputs.addressableFUA.value)) || 0,
                b4: (parseFloat(DOMElements.inputs.growthAssumption.value) || 0) / 100,
                b5: (parseFloat(DOMElements.inputs.conversionAssumption.value) || 0) / 100,
                b7: (parseFloat(DOMElements.inputs.aceFee.value) || 0) / 100,
                b8: (parseFloat(DOMElements.inputs.aceWeight.value) || 0) / 100,
                b9: parseFloat(cleanNumberString(DOMElements.inputs.minRevenue.value)) || 0,
                b10: parseFloat(cleanNumberString(DOMElements.inputs.targetRevenue.value)) || 0,
                manualBaseFee: (parseFloat(DOMElements.inputs.manualBaseFee.value) || 0) / 100,
            };
        }

        function performCalculations(values) {
            const denominator = values.b5 * (values.b3 * Math.pow(1 + values.b4, config.growthCompoundingYears));
            
            let baseRevenue;
            if (config.feeMode === 'manual') {
                baseRevenue = values.b3 * values.b5 * values.manualBaseFee;
            } else { // tiered
                baseRevenue = calculateTieredBaseRevenue(values.b3) * values.b5;
            }

            const aceRevenue = config.includeACE ? (denominator * values.b8 * values.b7) : 0;
            const totalRevenue = baseRevenue + aceRevenue;
            return { minFee: denominator === 0 ? 0 : values.b9 / denominator, targetFee: denominator === 0 ? 0 : values.b10 / denominator, baseRevenue, aceRevenue, totalRevenue };
        }

        function calculateAndDisplay() {
            const values = getParsedInputs();
            const results = performCalculations(values);
            DOMElements.outputs.minFee.textContent = formatPercent(results.minFee);
            DOMElements.outputs.targetFee.textContent = formatPercent(results.targetFee);
            DOMElements.outputs.baseRevenue.textContent = formatCurrency(results.baseRevenue);
            DOMElements.outputs.aceRevenue.textContent = formatCurrency(results.aceRevenue);
            DOMElements.outputs.totalRevenue.textContent = formatCurrency(results.totalRevenue);
            
            let effectiveBaseFeeDecimal = 0;
            if (values.b3 > 0 && values.b5 > 0) {
                effectiveBaseFeeDecimal = results.baseRevenue / (values.b3 * values.b5);
            }
            DOMElements.outputs.effectiveBaseFee.textContent = formatPercent(effectiveBaseFeeDecimal);

            DOMElements.warnings.text.textContent = config.warningMessage;
            if (results.totalRevenue < config.warningThreshold && results.totalRevenue > 0) {
                DOMElements.warnings.message.classList.remove('hidden');
                DOMElements.outputs.totalRevenue.classList.replace('text-blue-600', 'text-red-600');
            } else {
                DOMElements.warnings.message.classList.add('hidden');
                DOMElements.outputs.totalRevenue.classList.replace('text-red-600', 'text-blue-600');
            }
            updateChart();
            updateGuidanceHighlight();
        }

        function saveSettings() {
            const newPass = DOMElements.admin.password.newPass.value;
            const confirmPass = DOMElements.admin.password.confirmPass.value;
            DOMElements.admin.password.updateError.classList.add('hidden');
            DOMElements.admin.password.updateSuccess.classList.add('hidden');
            if (newPass || confirmPass) {
                if (newPass === confirmPass && newPass !== "") {
                    config.password = newPass;
                    DOMElements.admin.password.updateSuccess.classList.remove('hidden');
                    setTimeout(() => DOMElements.admin.password.updateSuccess.classList.add('hidden'), 3000);
                    DOMElements.admin.password.newPass.value = '';
                    DOMElements.admin.password.confirmPass.value = '';
                } else {
                    DOMElements.admin.password.updateError.classList.remove('hidden'); return;
                }
            }
            config.growthCompoundingYears = parseFloat(DOMElements.admin.settings.growthYears.value) || defaultConfig.growthCompoundingYears;
            
            config.feeTiers = [
                { fuaUpTo: parseFloat(cleanNumberString(DOMElements.admin.settings.tier1FUA.value)) || 0, fee: parseFloat(DOMElements.admin.settings.tier1Fee.value) || 0 },
                { fuaUpTo: parseFloat(cleanNumberString(DOMElements.admin.settings.tier2FUA.value)) || 0, fee: parseFloat(DOMElements.admin.settings.tier2Fee.value) || 0 },
                { fuaUpTo: Infinity, fee: parseFloat(DOMElements.admin.settings.tier3Fee.value) || 0 }
            ];
            
            localStorage.setItem('ascalonFeeCalcSettings', JSON.stringify(config));
            calculateAndDisplay();
            closeModal(DOMElements.admin.settings.modal);
        }

        function loadSettings() {
            const saved = localStorage.getItem('ascalonFeeCalcSettings');
            if (saved) {
                const parsed = JSON.parse(saved);
                config = { ...defaultConfig, ...parsed };
                
                // BUG FIX: Handle 'Infinity' which becomes 'null' after JSON.parse
                if (config.feeTiers && Array.isArray(config.feeTiers)) {
                    config.feeTiers.forEach(tier => {
                        if (tier.fuaUpTo === null) {
                            tier.fuaUpTo = Infinity;
                        }
                    });
                } else {
                    config.feeTiers = defaultConfig.feeTiers;
                }
            }
            DOMElements.admin.settings.growthYears.value = config.growthCompoundingYears;
            
            // BUG FIX: Sort the tiers before displaying them to ensure correct order
            const sortedTiers = [...config.feeTiers].sort((a, b) => a.fuaUpTo - b.fuaUpTo);
            DOMElements.admin.settings.tier1FUA.value = formatNumberWithCommas(sortedTiers[0].fuaUpTo);
            DOMElements.admin.settings.tier1Fee.value = sortedTiers[0].fee;
            DOMElements.admin.settings.tier2FUA.value = formatNumberWithCommas(sortedTiers[1].fuaUpTo);
            DOMElements.admin.settings.tier2Fee.value = sortedTiers[1].fee;
            DOMElements.admin.settings.tier3Fee.value = sortedTiers[2].fee;
            
            DOMElements.inputs.manualBaseFee.value = config.manualBaseFee;
            setFeeModeUI(config.feeMode);
            setAceUI(config.includeACE);
        }
        
        function setFeeModeUI(mode) {
            const manualInput = DOMElements.inputs.manualBaseFee;
            const container = DOMElements.containers.manualBaseFee;

            if (mode === 'manual') {
                DOMElements.toggles.feeMode.checked = false;
                container.classList.remove('opacity-50');
                manualInput.disabled = false;
                manualInput.classList.remove('bg-gray-100', 'cursor-not-allowed');
            } else { // tiered
                DOMElements.toggles.feeMode.checked = true;
                container.classList.add('opacity-50');
                manualInput.disabled = true;
                manualInput.classList.add('bg-gray-100', 'cursor-not-allowed');
            }
        }
        
        function setAceUI(enabled) {
            DOMElements.toggles.includeAce.checked = enabled;
            const containers = [DOMElements.containers.aceFee, DOMElements.containers.aceWeight];
            const inputs = [DOMElements.inputs.aceFee, DOMElements.inputs.aceWeight];

            if (enabled) {
                containers.forEach(c => c.classList.remove('opacity-50'));
                inputs.forEach(i => {
                    i.disabled = false;
                    i.classList.remove('bg-gray-100', 'cursor-not-allowed');
                });
            } else {
                containers.forEach(c => c.classList.add('opacity-50'));
                inputs.forEach(i => {
                    i.disabled = true;
                    i.classList.add('bg-gray-100', 'cursor-not-allowed');
                });
            }
        }

        function updateGuidanceHighlight() {
            const selectedValue = parseInt(DOMElements.inputs.conversionAssumption.value, 10);
            const rows = DOMElements.guidance.tableBody.querySelectorAll('tr');
            
            rows.forEach(row => {
                row.classList.remove('bg-blue-100');
                row.classList.add('bg-white');
            });

            let targetRowId;
            if (selectedValue >= 70) {
                targetRowId = 'guidance-row-70';
            } else if (selectedValue <= 40) {
                targetRowId = 'guidance-row-40';
            } else {
                targetRowId = `guidance-row-${selectedValue}`;
            }

            const targetRow = document.getElementById(targetRowId);
            if (targetRow) {
                targetRow.classList.add('bg-blue-100');
                targetRow.classList.remove('bg-white');
            }
        }

        function handleLoginAttempt() {
            if (DOMElements.admin.password.input.value === config.password) {
                DOMElements.admin.password.input.value = '';
                DOMElements.admin.password.error.classList.add('hidden');
                closeModal(DOMElements.admin.password.modal);
                openModal(DOMElements.admin.settings.modal);
            } else {
                DOMElements.admin.password.error.classList.remove('hidden');
            }
        }
        
        function setupChart() {
            const ctx = DOMElements.chart.canvas.getContext('2d');
            feeChartInstance = new Chart(ctx, {
                type: 'line',
                data: { labels: [], datasets: [] },
                options: {
                    responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false },
                    scales: {
                        x: { title: { display: true, text: 'Addressable FUA' } },
                        y: { title: { display: true, text: 'Required Base Fee %' },
                             ticks: { callback: (value) => formatPercent(value) }
                        }
                    },
                    plugins: { 
                        legend: {
                            labels: {
                                usePointStyle: true,
                                pointStyle: 'rectRounded',
                                boxWidth: 12,
                                boxHeight: 8,
                            }
                        },
                        tooltip: { callbacks: { label: (context) => `Required Fee: ${formatPercent(context.raw)}` } } 
                    }
                }
            });
        }

        // --- Event Listeners & Initialisation ---
        const closeModal = (m) => m.classList.remove('active');
        const openModal = (m) => m.classList.add('active');
        Object.values(DOMElements.inputs).forEach(input => input.addEventListener(input.tagName.toLowerCase() === 'select' ? 'change' : 'input', calculateAndDisplay));
        currencyInputs.forEach(input => input.addEventListener('input', (e) => {
            const val = e.target.value; const pos = e.target.selectionStart; const len = val.length;
            e.target.value = formatNumberWithCommas(val);
            e.target.setSelectionRange(pos + (e.target.value.length - len), pos + (e.target.value.length - len));
        }));
        
        DOMElements.toggles.feeMode.addEventListener('change', (e) => {
            config.feeMode = e.target.checked ? 'tiered' : 'manual';
            if(config.feeMode === 'manual') {
                config.manualBaseFee = (parseFloat(DOMElements.inputs.manualBaseFee.value) || 0);
            }
            localStorage.setItem('ascalonFeeCalcSettings', JSON.stringify(config));
            setFeeModeUI(config.feeMode);
            calculateAndDisplay();
        });
        
        DOMElements.toggles.includeAce.addEventListener('change', (e) => {
            config.includeACE = e.target.checked;
            localStorage.setItem('ascalonFeeCalcSettings', JSON.stringify(config));
            setAceUI(config.includeACE);
            calculateAndDisplay();
        });

        DOMElements.chart.targetToggle.addEventListener('change', updateChart);
        DOMElements.admin.openBtn.addEventListener('click', () => openModal(DOMElements.admin.password.modal));
        DOMElements.admin.password.loginBtn.addEventListener('click', handleLoginAttempt);
        DOMElements.admin.password.input.addEventListener('keyup', (e) => e.key === 'Enter' && handleLoginAttempt());
        DOMElements.admin.settings.saveBtn.addEventListener('click', saveSettings);
        DOMElements.admin.settings.resetBtn.addEventListener('click', () => { if (confirm("Reset settings to default?")) { localStorage.removeItem('ascalonFeeCalcSettings'); config = { ...defaultConfig }; loadSettings(); saveSettings(); } });
        [DOMElements.admin.password.modal, DOMElements.admin.settings.modal].forEach(modal => modal.addEventListener('click', (e) => e.target === modal && closeModal(modal)));

        loadSettings();
        setupChart();
        calculateAndDisplay();
    });
    </script>
</body>
</html>
